<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Max K-Digit Number (No Swap) Visualizer – Multi</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
            color: #e5e7eb;
            margin: 0;
            padding: 2rem;
            display: flex;
            justify-content: center;
        }

        .app {
            width: 100%;
            max-width: 900px;
            background: rgba(15, 23, 42, 0.95);
            border-radius: 1.5rem;
            padding: 1.75rem 2rem 2.25rem;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.55);
            border: 1px solid rgba(148, 163, 184, 0.3);
        }

        h1 {
            margin-top: 0;
            font-size: 1.6rem;
            letter-spacing: 0.03em;
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        h1 span.logo-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 999px;
            background: linear-gradient(135deg, #22c55e, #06b6d4);
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 8px 20px rgba(34, 197, 94, 0.4);
        }

        .subtitle {
            margin-top: 0.2rem;
            margin-bottom: 1.25rem;
            color: #9ca3af;
            font-size: 0.9rem;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
            align-items: stretch;
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .field textarea,
        .field input {
            padding: 0.45rem 0.55rem;
            border-radius: 0.75rem;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: rgba(15, 23, 42, 0.85);
            color: #e5e7eb;
            outline: none;
            min-width: 0;
            resize: vertical;
        }

        .field textarea {
            min-height: 72px;
            max-height: 200px;
        }

        .field textarea:focus,
        .field input:focus {
            border-color: #22c55e;
            box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.8);
        }

        .btn {
            border: none;
            border-radius: 999px;
            padding: 0.6rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            background: linear-gradient(135deg, #22c55e, #0ea5e9);
            color: #0b1120;
            box-shadow: 0 15px 35px rgba(34, 197, 94, 0.4);
            transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.12s ease;
            white-space: nowrap;
            height: fit-content;
            align-self: flex-end;
        }

        .btn:disabled {
            opacity: 0.4;
            cursor: default;
            box-shadow: none;
        }

        .btn:not(:disabled):hover {
            transform: translateY(-1px);
            box-shadow: 0 18px 40px rgba(34, 197, 94, 0.55);
        }

        .btn-icon {
            font-size: 1rem;
        }

        .visualizer {
            border-radius: 1.25rem;
            background: radial-gradient(circle at top left, rgba(148, 163, 184, 0.18), transparent 55%);
            padding: 1.4rem 1.1rem 1.4rem;
            border: 1px solid rgba(51, 65, 85, 0.9);
            position: relative;
            overflow: hidden;
            margin-top: 100px;
        }

        .row-label {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-bottom: 0.3rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
        }

        .digits-row,
        .stack-row {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            min-height: 48px;
            flex-wrap: wrap;
        }

        .digit-box {
            width: 34px;
            height: 34px;
            border-radius: 0.9rem;
            border: 1px solid rgba(75, 85, 99, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1rem;
            color: #e5e7eb;
            background: rgba(15, 23, 42, 0.9);
            box-shadow: 0 8px 16px rgba(15, 23, 42, 0.7);
            position: relative;
            transition: transform 0.16s ease, box-shadow 0.16s ease, background 0.16s ease, border-color 0.16s ease, color 0.16s ease, opacity 0.16s ease;
        }

        .digit-box.current {
            border-color: #22c55e;
            background: radial-gradient(circle at top, rgba(34, 197, 94, 0.18), rgba(15, 23, 42, 0.9));
            box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.6), 0 12px 24px rgba(34, 197, 94, 0.35);
            transform: translateY(-2px) scale(1.02);
        }

        .digit-box.stack {
            background: radial-gradient(circle at top, rgba(56, 189, 248, 0.15), rgba(15, 23, 42, 0.92));
            border-color: rgba(56, 189, 248, 0.8);
        }

        .digit-box.push-enter {
            transform: translateY(18px);
            opacity: 0;
        }

        .digit-box.push-enter-active {
            transform: translateY(0);
            opacity: 1;
        }

        .digit-box.pop-exit {
            animation: pop-out 0.35s ease forwards;
        }

        @keyframes pop-out {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            20% {
                transform: translateY(-4px) scale(1.05) rotate(0deg);
            }

            50% {
                transform: translateY(2px) scale(0.96) rotate(-3deg);
            }

            100% {
                transform: translateY(-18px) scale(0.7) rotate(5deg);
                opacity: 0;
            }
        }

        .visualizer-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            row-gap: 0.9rem;
            column-gap: 1rem;
        }

        .status-bar {
            margin-top: 1rem;
            font-size: 0.85rem;
            color: #9ca3af;
            display: flex;
            justify-content: space-between;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .status-pill {
            padding: 0.3rem 0.7rem;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            font-size: 0.75rem;
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            background: rgba(15, 23, 42, 0.9);
        }

        .status-pill-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: #22c55e;
            box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.7);
        }

        .pill-warning .status-pill-dot {
            background: #f97316;
            box-shadow: 0 0 0 1px rgba(249, 115, 22, 0.7);
        }

        .pill-error .status-pill-dot {
            background: #ef4444;
            box-shadow: 0 0 0 1px rgba(248, 113, 113, 0.7);
        }

        .code-note {
            margin-top: 0.6rem;
            font-size: 0.78rem;
            color: #6b7280;
            font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }

        .current-string-info {
            font-size: 0.8rem;
            color: #9ca3af;
            margin-bottom: 0.4rem;
            display: none;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 0.4rem;
            align-items: center;
        }

        .current-string-value {
            font-family: "JetBrains Mono", ui-monospace;
            font-size: 0.8rem;
            color: #e5e7eb;
            background: rgba(15, 23, 42, 0.9);
            border-radius: 999px;
            padding: 0.2rem 0.6rem;
            border: 1px solid rgba(55, 65, 81, 0.9);
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        @media (max-width: 640px) {
            body {
                padding: 1rem;
            }

            .app {
                padding: 1.2rem 1.2rem 1.5rem;
            }

            .digits-row,
            .stack-row {
                min-height: 40px;
            }

            .digit-box {
                width: 30px;
                height: 30px;
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="app">
        <h1>
            <span class="logo-badge">K</span>
            Max K-digit in Order — Visualizer
        </h1>
        <p class="subtitle">
            Greedy stack algorithm: pick K digits in order to form the largest possible number (no swaps).
            Now supports multiple input strings.
        </p>

        <div class="controls">
            <div class="field" style="flex: 2 1 260px;">
                <label for="digitsInput">Digits strings (one per line)</label>
                <textarea id="digitsInput">811111111111119
987654321012345
1234512399999</textarea>
            </div>

            <div class="field">
                <label for="kInput">K (number of digits)</label>
                <input id="kInput" type="number" min="1" max="50" value="12" style="width: 80px;">
            </div>

            <button class="btn" id="playBtn">
                <span class="btn-icon">▶️</span>
                Play animation
            </button>
        </div>

        <div class="visualizer">
            <div class="current-string-info">
                <div id="stringIndexInfo">String 0 of 0</div>
                <div id="currentStringValue" class="current-string-value">—</div>
            </div>

            <div class="visualizer-grid">
                <div>
                    <div class="row-label">Input digits</div>
                </div>
                <div id="digitsRow" class="digits-row"></div>

                <div>
                    <div class="row-label">Stack</div>
                </div>
                <div id="stackRow" class="stack-row"></div>
            </div>
        </div>
    </div>

    <script>
        const digitsInput = document.getElementById("digitsInput");
        const kInput = document.getElementById("kInput");
        const playBtn = document.getElementById("playBtn");
        const digitsRow = document.getElementById("digitsRow");
        const stackRow = document.getElementById("stackRow");
        const stringIndexInfo = document.getElementById("stringIndexInfo");
        const currentStringValue = document.getElementById("currentStringValue");

        let animating = false;

        function renderDigits(str) {
            digitsRow.innerHTML = "";
            [...str].forEach((ch, idx) => {
                const box = document.createElement("div");
                box.className = "digit-box";
                box.textContent = ch;
                box.dataset.index = idx;
                digitsRow.appendChild(box);
            });
        }

        function clearStack() {
            stackRow.innerHTML = "";
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function highlightIndex(i) {
            const boxes = digitsRow.querySelectorAll(".digit-box");
            boxes.forEach(box => box.classList.remove("current"));
            const current = digitsRow.querySelector(`.digit-box[data-index="${i}"]`);
            if (current) current.classList.add("current");
        }

        function makeStackBox(value) {
            const box = document.createElement("div");
            box.className = "digit-box stack push-enter";
            box.textContent = value;
            return box;
        }

        async function animateSingleString(str, K, index, total) {
            stringIndexInfo.textContent = `String ${index + 1} of ${total}`;
            currentStringValue.textContent = str;
            renderDigits(str);
            clearStack();

            const n = str.length;
            const digits = [...str].map(ch => ch.charCodeAt(0) - 48);
            const stack = [];

            for (let i = 0; i < n; i++) {
                const d = digits[i];

                highlightIndex(i);
                await sleep(55);

                let poppedAtLeastOne = false;
                while (
                    stack.length > 0 &&
                    d > stack[stack.length - 1] &&
                    (stack.length - 1 + (n - i)) >= K
                ) {
                    poppedAtLeastOne = true;
                    const lastValue = stack.pop();

                    const stackBoxes = stackRow.querySelectorAll(".digit-box.stack");
                    const lastBox = stackBoxes[stackBoxes.length - 1];
                    if (lastBox) {
                        lastBox.classList.add("pop-exit");
                        await sleep(38);
                        lastBox.remove();
                    } else {
                        break;
                    }
                }

                if (!poppedAtLeastOne) {
                    await sleep(35);
                }

                if (stack.length < K) {
                    stack.push(d);
                    const newBox = makeStackBox(d);
                    stackRow.appendChild(newBox);

                    requestAnimationFrame(() => {
                        newBox.classList.add("push-enter-active");
                    });

                    await sleep(45);
                } else {
                    await sleep(35);
                }
            }

            highlightIndex(-1);
            const result = stack.join("");
            await sleep(65);
        }

        async function playAnimation() {
            if (animating) return;

            let lines = digitsInput.value
                .split("\n")
                .map(s => s.trim())
                .filter(s => s.length > 0);

            if (lines.length === 0) {
                return;
            }

            const K = parseInt(kInput.value, 10);
            if (isNaN(K) || K < 1) {
                return;
            }

            // basic validation for all strings before starting animation
            for (let i = 0; i < lines.length; i++) {
                const s = lines[i];
                if (!/^\d+$/.test(s)) {
                    return;
                }
                if (K > s.length) {
                    return;
                }
            }

            animating = true;
            playBtn.disabled = true;

            for (let i = 0; i < lines.length; i++) {
                await animateSingleString(lines[i], K, i, lines.length);
            }

            animating = false;
            playBtn.disabled = false;
        }

        playBtn.addEventListener("click", playAnimation);

        // initial render (for first line)
        (function init() {
            const firstLine = digitsInput.value.split("\n")[0].trim();
            if (firstLine) {
                stringIndexInfo.textContent = "String 1 of ?";
                currentStringValue.textContent = firstLine;
                renderDigits(firstLine);
            }
        })();
    </script>
</body>

</html>